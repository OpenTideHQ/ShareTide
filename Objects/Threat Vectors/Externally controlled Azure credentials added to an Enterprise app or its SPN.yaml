name: Externally controlled Azure credentials added to an Enterprise app or its SPN
criticality: Medium
references:
  public:
    1: https://www.secureworks.com/research/abusing-azure-application-credentials-to-attack-supply-chains
    2: https://media.defense.gov/2020/Dec/17/2002554125/-1/-1/0/AUTHENTICATION_MECHANISMS_CSA_U_OO_198854_20.PDF
  #internal:
    #a: 
  #restricted:
    #A: 
  #reports:
    #-

metadata:
  uuid: ca2751c7-8641-4fb0-a90b-30c5987015dc
  schema: tvm::2.0
  tlp: clear
  version: 1
  created: 2022-11-28
  modified: 2022-11-28
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  #actors:
    #- 
  killchain: Lateral Movement
  att&ck:
    - T1098.003
  domains:
    - Public Cloud
  terrain: |
    A threat actor needs to control highly privileged Azure credentials in
    order to be able to assign Azure credentials to an Azure Enterprise app or
    it's service principal
  targets:
    - API Endpoints
    - Auth token
    - CI/CD Pipelines
    - Cloud Portal
    - Identity Services
  platforms:
    - Azure AD
  severity: Localised incident
  leverage:
    - Information Disclosure
    - Modify configuration
    - Modify data
    - Modify privileges
    - Infrastructure Compromise
    - Dwelling
  impact:
    - Data Breach
    - Identity Theft
    - IP Loss
  viability: Likely
  description: |
    Threat actors may assign valid azure credentials to an Azure Enterprise App or its SPN (service
    principal). NSA writes in its advisory that the app was seen leveraged
    to access emails from the Enterprise app, but the attack vector could be
    used for many other types of leverage.
