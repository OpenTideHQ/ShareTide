name: Disabling of Windows event logging through registry entries
criticality: Medium
references:
  public:
    1: https://www.thewindowsclub.com/enable-or-disable-protected-event-logging-in-windows
    2: https://superuser.com/questions/1516725/how-to-disable-windows-10-system-log
    3: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-add
    4: https://stackoverflow.com/questions/41047761/how-to-change-dword-registry-entry-with-bat-file
  #internal:
    #a: 
  #restricted:
    #A: 
  #reports:
    #-

metadata:
  uuid: dbbeb66b-cb18-4055-8af4-808a8efdc748
  schema: tvm::2.0
  tlp: clear
  version: 3
  created: 2022-12-22
  modified: 2023-01-05
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: att&ck::G0016 #[Enterprise] APT29, Blue Kitsune, Cozy Bear, CozyDuke, Dark Halo, IRON HEMLOCK, IRON RITUAL, Midnight Blizzard, NOBELIUM, NobleBaron, SolarStorm, The Dukes, UNC2452, UNC3524, YTTRIUM
    - name: misp::2ee5ed7a-c4d0-40be-a837-20817474a15b #UNC2452, DarkHalo, StellarParticle, NOBELIUM, Solar Phoenix, Midnight Blizzard
    - name: att&ck::G0034 #[Enterprise] Sandworm Team, APT44, BlackEnergy (Group), ELECTRUM, FROZENBARENTS, IRIDIUM, IRON VIKING, Quedagh, Seashell Blizzard, Telebots, Voodoo Bear
    - name: misp::d52ca4c4-d214-11e8-8d29-c3e7cb78acce #GreyEnergy
  killchain: Defense Evasion
  att&ck:
    - T1562.002
  domains:
    - Enterprise
    - Public Cloud
    - Private Cloud
  terrain: |
    A threat actor has gained control over a Windows endpoint and has
    privileges to disable event logging (in bulk or specific entries)
    through registry entries.
  targets:
    - Workstations
    - Control Server
    - Desktop
    - Input/Output Server
    - Laptop
    - Server Logs
    - Web Application Servers
    - Public-Facing Servers
  platforms:
    - Windows
  severity: Moderate incident
  leverage:
    - Log tampering
  impact:
    - Impairement
  viability: Likely
  description: |
    Threat actors can disable Windows event logs by adding, deleting or modifying
    registry entries manually or with commands in a command-line prompt. 

    The threat actor may disable the Windows Event log events manually via
    Event Viewer properties or with CLI commands to disable a specific event or
    all of them. Threat actors may also use script files or PowerShell to change
    the registry.

    If the threat actors want to disable event logging manually via registry
    entries, they have to find the associated GUID to the event that will delete. The
    GUID can be taken for example from Event Viewer > Select specific event log
    > Event Properties > in Details select "XML view". (example for GUID id:
    Giud="{BD12F3B8-4DE1-TR31-DE39RET84L12}") After this the threat actor
    navigates to the registry with the GUID that needs to delete and change
    the value of the dword in the registry key "Enabled" to 0.

    Example: 

    1. Example for disabling the logging of all event logs via registry entry:

    reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog" /v Start /t REG_DWORD /d 4 /f

    2. Example for disabling the logging of a specific event log via registry entry:

    reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog[Log Name]" /v TypesSupported /t REG_DWORD /d 0 /f

    3. Manual change in the registry of the registry key "Enable" (dword value) to 0. 
      
      Registry: 
      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System

      Dword value change in the registry key "Enable":
    
      "Enabled"=dword:0
      "EnableProperty"=dword:0
    
    Example for change of Audit policies in the registries:

    psexec -s -i regedit (the command needs system-level access to run)
    After that in HKLM\SECURITY\Policy\PolAdtEv registry hive in the registry
    editor "Edit Binary Value", 16-bit (two-byte) values can be changed to
    00 00 which means no audit. For example replace the data started with 
    01 00 01 00 to 00 00 00 00

    - 00 00 means no auditing
    - 01 00 means success auditing
    - 02 00 means failure auditing
    - 03 00 means all auditing



