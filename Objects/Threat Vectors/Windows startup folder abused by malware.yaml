name: Windows startup folder abused by malware
criticality: High
references:
  public:
    1: https://www.bleepingcomputer.com/news/security/winrar-zero-day-flaw-exploited-by-romcom-hackers-in-phishing-attacks
    2: https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability # RomCom and others exploiting WinRAR zero-day vulnerability
    3: https://www.tenforums.com/general-support/193812-what-3-folders-start-menu-programs-startup.html # examples for some of the Startup Windows folders
    4: https://www.easeus.com/file-recovery/windows-10-startup-folder.html # a PowerShell command in the start menu `shell:common startup` shows Startup folders on Windows system
    5: https://softwarekeep.com/blogs/how-to/how-to-find-the-startup-folder-in-windows-10
    6: https://www.tenforums.com/general-support/193812-what-3-folders-start-menu-programs-startup.html # Which are the 3 folders for: Start Menu, Programs, Startup 
    7: https://www.elastic.co/security-labs/playing-defense-against-gamaredon-group # Gamaredon, LNK loaders

metadata:
  uuid: cce22952-735a-4255-8319-e5e44aef9d85
  schema: tvm::2.1
  version: 1
  created: 2025-08-21
  modified: 2025-08-22
  tlp: clear
  #author: 
  #contributors:
    #-
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: misp::ba9e1ed2-e142-48d0-a593-f73ac6d59ccd # RomCom, Storm-0978, UAT-5647, also known as Tropical Scorpius or UNC2596
      sighting: |
        Russia-linked threat actor RomCom exploited WinRAR a vulnerability as a
        zero-day in spearphishing attacks to deploy various backdoors ref [2].
      references:
        - https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability
    
    - name: misp::1a77e156-76bc-43f5-bdd7-bd67f30fbbbb #Gamaredon Group, ACTINIUM, DEV-0157, Blue Otso, BlueAlpha, G0047, IRON TILDEN, PRIMITIVE BEAR, Shuckworm, Trident Ursa, UAC-0010, Winterflounder, Aqua Blizzard, Actinium
    - name: att&ck::G0047 #[Enterprise] Gamaredon Group, ACTINIUM, Aqua Blizzard, Armageddon, DEV-0157, IRON TILDEN, Primitive Bear, Shuckworm
      sighting: |
        Gamaredon Group is believed to be with Russian origin. They are observed
        to leveraged both malicious Windows shortcut files and script objects
        written to the Startup folder for persistence.
        
        Example: `file_path == "*\\Programs\\Startup\\*.lnk` ref [7].
      references:
        - https://www.elastic.co/security-labs/playing-defense-against-gamaredon-group
  killchain: Persistence
  att&ck:
    - T1547.001 # Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder, example: RomCom stores an LNK file in the Startup folder
  chaining:
    - relation: sequence::succeeds
      vector: dd5d942c-bac4-4000-b9a6-ca4fef6cfb84 # Spearphishing Attachment
      description: |
        A threat actor can use an initial threat vector, for example
        spear-phishing with attachment to impant a malware on the system. 
    
    - relation: atomicity::implements
      vector: 86f62c3a-6556-4a64-a9f5-a79168ad42d9 # Abuse Windows Utilities to Side-Load Malicious DLLs
      description: |
        Threat actor stores an LNK file in the Startup folder. For example, a
        malicious DLL is deployed into ``%TEMP%` directory. Threat actors deploy
        malicious .dll binaries with the goal to remain undetected ref [2].   
  cve:
    - CVE-2025-8088 # It's a path traversal vulnerability affecting the Windows version of WinRAR allows the attackers to execute arbitrary code. 
  domains:
    - Enterprise
    - Private Cloud
    - Public Cloud
  terrain: |
    A threat actor needs an initial access to a targeted Windows system.  
  targets:
    - Directory
    - Workstations
    - Laptop
    - Customer
    - End-user
    - Other # a Windows Startup folder
  platforms:
    - Windows
  severity: Significant incident
  leverage:
    - Infrastructure Compromise
    - Elevation of privilege
    - Tampering
    - Modify configuration
  impact:
    - Impairement
    - Lose Capabilities
  viability: Likely
  description: |
    The Windows Startup folder is a legitimate feature in Windows that allows
    users to specify programs or applications to launch automatically when the
    operating system starts. In several reports and analysis different threat
    actors have been known to abuse this feature to achieve persistence and
    evade detection on compromised systems. 

    As a first step the malware is distributed by an initial threat vector, for
    example spear-phishing attack. Once the malware is on the targeted system it
    creates a shortcut or executable file in the Windows Startup folder
    ref [5], [6].
    
    There are several different possible startup locations which can be used
    by the threat actors to run malicious programs. 

    Examples:
    
    - `C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`
    - `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup`.
    - `C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`
    - `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup`

    A recent campaign, ref [2], showed threat actors exploiting a vulnerability
    in a software application  to deploy shortcut files in the startup folder,
    that would point to the malicious executable.

    When the user logs in or the system boots, Windows automatically executes
    the programs or applications in the Startup folder. Usually the malware is
    disguised as a legitimate program and runs in the background, often without 
    the user's knowledge or consent.

    ### Techniques used by malware

    - Shortcut files: Malware creates a shortcut file (.lnk) in the Startup
      folder, pointing to the malicious executable.
    - Executable files: Malware places an executable file (.exe) directly in the
      Startup folder.
    - Registry modifications: Some malware (Amadey) may also overwrite the 
    Windows registry key, thush changing the startup folder to the ones 
    containing its payload.
    - Scripts - some threat actors have used the startup folder as a persistence 
    mechanism to execute script files.
    - Archive exploitation: WinRAR or crafted installers extract payloads into
      the Startup folder (notably CVE-2023-38831 exploited in the wild).

    ### Known malware families which can abuse a Windows Startup folder

    - Ransomware: Some ransomware variants, like WannaCry and NotPetya, used
      the Startup folder to launch their malicious payloads.
    - Trojans: Trojans, such as Emotet and TrickBot, have been known to use the
      Startup folder to maintain persistence on compromised systems.
    - Adware/PUP: Adware or Potentially Unwanted Programs (PUPs), like the 
    notorious Ask Toolbar, has been found to use the Startup folder to launch 
    themselves.  
    - LNK Loaders (e.g Gamaredon) ref [7].
