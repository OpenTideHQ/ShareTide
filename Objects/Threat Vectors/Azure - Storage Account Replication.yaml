name: Azure - Storage Account Replication
criticality: High
references:
  public:
    1: https://microsoft.github.io/Azure-Threat-Research-Matrix/Impact/AZT703/AZT703-1/
    2: https://www.microsoft.com/en-us/security/blog/2023/09/07/cloud-storage-security-whats-new-in-the-threat-matrix/
    3: https://learn.microsoft.com/en-us/azure/storage/blobs/object-replication-overview
    4: https://www.modepush.com/blog/highway-blobbery-data-theft-using-azure-storage-explorer
  #internal:
    #a: 

metadata:
  uuid: 942ed69c-700a-469a-9591-07b87815a909
  schema: tvm::2.1
  version: 1
  created: 2025-09-08
  modified: 2025-09-08
  tlp: clear
  #author: 
  contributors:
    - jaime.montane-lorenzo@ext.ec.europa.eu
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: misp::f6a60403-4bcc-4fc6-ac07-abb913c1f080 #Storm-0501
      sighting: |
        The actor undertook a series of operations that led to data exfiltration and 
        deletion. This included a comprehensive discovery phase to locate the organisation’s 
        critical assets, including data stores that contained sensitive information.
      references:
        - https://www.infosecurity-magazine.com/news/ransomware-deletes-data-backups/
  killchain: Impact
  att&ck:
    - T1567.002 #Exfiltration Over Web Service: Exfiltration to Cloud Storage
    - T1078.004 #Valid Accounts: Cloud Accounts
    - T1530 #Data from Cloud Storage
  chaining:
    - relation: support::enabled
      vector: 53f4e2f0-7d11-4629-bb26-905993a589db #Azure - Storage account reconnaissance
      description: |
        Adversaries need to scan and discover publicly accessible storage containers by 
        guessing or enumerating storage account and container names.
    - relation: sequence::preceeds
      vector: 2743bf18-3b86-4721-bf3e-153dcda0b149 #Azure - Valid Credentials
      description: |
        Adversaries obtain the username and password of an AzureAD user either through
        phishing, password spraying, brute-force attacks, or credentials leaked online.
    - relation: support::enabled
      vector: 41f57a57-1ed6-407e-bb70-a0f6ab52af10 #Azure - Storage Blobs Reconnaissance
      description: |
        Adversaries must have knowledge about the strucuture of Azure Blob Storage and 
        naming conventions, and basic enumeration tools or scripts to carry out 
        reconnaissance-especially when misconfigurations or public access are present.
    - relation: support::enabled
      vector: 2d7ed070-e5c5-4796-b150-ea1d02ed1785 #Azure - Storage container reconnaissance
      description: |
        Adversaries need to enumerate and discover publicly accessible or misconfigured 
        Azure storage containers by scanning for storage account names and container names, 
        often using automated tools or scripts, to identify open containers that may expose 
        sensitive data.
  #cve:
    #-
  #misp:
    #-
  domains:
    - Public Cloud   
  terrain: |
    Adversaries obtains credentials or elevated permissions (via access keys, Service 
    Principal abuse, RBAC misconfigurations, or privilege escalation) to the victim’s 
    storage account.
  targets:
    - Cloud Storage Accounts
    - API Endpoints
    - Cloud Portal
  platforms:
    - Azure
    - Azure AD
  severity: Significant incident
  leverage:
    - Information Disclosure
    - Elevation of privilege
    - Repudiation
    - Tampering 
  impact:
    - Data Breach
    - IP Loss
    - Reputational Damages
    - Identity Theft
    - Business disruption
  viability: Likely
  description: |
    The following threat vector enables adversaries to misuse Azure Storage's replication 
    features for data exfiltration or to facilitate other attacks with significant business impact.

    ## Example Attack Scenario

    An attacker compromises access to a victim's Azure Storage account, obtaining enough 
    permissions to configure **object replication**. The attacker then creates their 
    own storage account in a different Azure tenant or region and establishes a replication 
    policy from the victim's storage. As a result, sensitive or operational data is 
    asynchronously and automatically copied from the victim’s container to the attacker's 
    environment—potentially outside tenant or even cross-cloud provider lines—without 
    further interaction. The attacker can now access the replicated content at will, 
    maintaining persistence and visibility even if their original access to the victim 
    account is revoked.

    ## Attack Goals and Impact

    - **Exfiltration**: The primary goal is the **covert exfiltration of data**—potentially 
    at massive scale and with minimum detection, because the process leverages legitimate 
    replication mechanisms.
    - **Persistence and Stealth**: By using cross-region or cross-tenant replication, 
    an attacker ensures ongoing access to copied data even after being discovered and 
    evicted from the original environment.
    - **Evasion and Regulatory Breach**: Since Azure Storage object replication can 
    occur across geographical boundaries, this attack can make detection harder and 
    may also result in regulatory compliance violations (e.g., unauthorized cross-border 
    data transfers).
    - **Potential for Secondary Impact**: With replicated data, attackers may enable 
    ransomware (encrypting or destroying primary data, but retaining a copy elsewhere), 
    enable further attacks by gleaning credentials or configuration details from exfiltrated 
    files, or deliver **malware** to victim environments using inbound replication.

    ## Attack Flow and Methodology

    1. The adversary enumerates storage resources, searches for containers of interest, 
    and assesses the feasibility of replication configuration.
    2. Using their access, the attacker creates an **object replication policy** from 
    victim storage to a destination account they control, potentially in a different 
    geographic region or Azure tenant.
        - Outbound replication exfiltrates data; inbound can inject payloads.
        - Cross-tenant replication may currently require explicit configuration, and 
        new Azure defaults restrict this, but legacy or misconfigured accounts remain vulnerable.
    3. Replication occurs asynchronously, repeatedly syncing new or changed objects. 
    The attacker harvests data from their own account, separate from the victim’s monitoring 
    and controls, thus bypassing many detection points.
    4. Depending on their goal, the attacker may leave replication running for long-term 
    persistence or attempt to erase traces from the victim environment.
