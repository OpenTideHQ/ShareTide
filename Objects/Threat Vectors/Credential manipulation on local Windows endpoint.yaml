name: Credential manipulation on local Windows endpoint
criticality: Medium
references:
  public:
    1: https://support.microsoft.com/en-us/windows/accessing-credential-manager-1b5c916a-6a16-889f-8581-fc16e8165ac0
    2: https://learn.microsoft.com/en-us/windows-server/security/windows-authentication/credentials-processes-in-windows-authentication
    3: https://www.pwndefend.com/2021/08/07/dumping-credentails-with-mimikatz-and-passing-the-hash-pth/
    4: https://www.microsoft.com/en-us/security/blog/2019/05/09/detecting-credential-theft-through-memory-access-modelling-with-microsoft-defender-atp/
    5: https://www.microsoft.com/en-us/security/blog/2018/09/27/out-of-sight-but-not-invisible-defeating-fileless-malware-with-behavior-monitoring-amsi-and-next-gen-av/
    6: https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/ 

metadata:
  uuid: ec8201d4-c135-406b-a3b5-4a070e80a2ee
  schema: tvm::2.0
  version: 4
  created: 2023-02-02
  modified: 2025-10-01
  tlp: clear
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: att&ck::G0034 #[Enterprise] Sandworm Team, APT44, BlackEnergy (Group), ELECTRUM, FROZENBARENTS, IRIDIUM, IRON VIKING, Quedagh, Seashell Blizzard, Telebots, Voodoo Bear
    - name: misp::d52ca4c4-d214-11e8-8d29-c3e7cb78acce #GreyEnergy
    - name: att&ck::G0069 #[Enterprise] MuddyWater, Earth Vetala, MERCURY, Mango Sandstorm, Seedworm, Static Kitten, TA450, TEMP.Zagros
    - name: misp::a29af069-03c3-4534-b78b-7d1a77ea085b #MuddyWater, TEMP.Zagros, Static Kitten, Seedworm, MERCURY, COBALT ULSTER, G0069, ATK51, Boggy Serpens, Mango Sandstorm, TA450, Earth Vetala
    - name: att&ck::G0129 #[Enterprise] Mustang Panda, BRONZE PRESIDENT, RedDelta, TA416
    - name: misp::fceed509-938e-4f9e-acd4-76e6c28dc6f1 #RedDelta
    - name: att&ck::G0117 #[Enterprise] Fox Kitten, Lemon Sandstorm, Parisite, Pioneer Kitten, RUBIDIUM, UNC757
    - name: misp::bfb0bc20-5bdf-47ff-b07f-dbd9a3cb9772 #Fox Kitten, PIONEER KITTEN, PARISITE, UNC757, Lemon Sandstorm, RUBIDIUM
  killchain: Credential Access
  att&ck:
    - T1098 #Account Manipulation
    - T1098.001 #Account Manipulation: Additional Cloud Credentials
    - T1552.001 #Unsecured Credentials: Credentials In Files
    - T1003.001 #OS Credential Dumping: LSASS Memory
    - T1003 #OS Credential Dumping
  chaining:
    - relation: sequence::succeeds
      vector: 5ea50181-1124-49aa-9d2c-c74103e86fd5 #Pass-the-hash on SMB network shares
      description: |
        In a **Pass-the-Hash attack (PtH)**, Attackers may use offensive tools to load 
        the NTLM hash and try to connect to SMB network shares that are...
    - relation: sequence::succeeds
      vector: 03cc9593-e7cf-484b-ae9c-684bf6f7199f #Pass the ticket using Kerberos ticket
      description: |
        Pass-the-Ticket using Kerberos tickets is an advanced method wherein threat 
        actors illicitly extract and exploit Kerberos tickets to gain unauthorized...
    - relation: sequence::succeeds
      vector: 479a8b31-5f7e-4fd6-94ca-a5556315e1b8 #Pass the hash using impersonation within existin...
      description: |
        Adversaries may use a particular flavor of pass the hash - to leverage 
        an acquired handle (hash) on NT AUTHORITY\SYSTEM access token to spawn a 
        new ...
    - relation: sequence::succeeds
      vector: 4472e2b0-3dca-4d84-aab0-626fcba04fce #Pass the hash attack to elevate privileges
      description: |
        Elevating privileges on Windows to System allows a threat actor (or 
        sysadmin) to do things that are not possible without SYSTEM/root 
        privileges.
    - relation: atomicity::implements
      vector: 7351e2ca-e198-427c-9cfa-202df36f6e2a #Mimikatz execution on compromised endpoint
      description: |
        Mimikatz is a very versatile tool that comes with a lot of 
        options and capabilities. Detection of known Atomic IOCs of 
        the mimikatz tool itself or...
    - relation: atomicity::implements
      vector: 06523ed4-7881-4466-9ac5-f8417e972d13 #  Windows command prompt for credential manipula...
      description: |
        Threat actors may use Windows commad prompt commands to search for, access
        in order to manipulate (create, modify, delete, read) user's credentials...
    - relation: atomicity::implements
      vector: e3d7cb59-7aca-4c3d-b488-48c785930b6d #PowerShell usage for credential manipulation
      description: |
        Threat actors are using different methods to manipulate user's credentials.
        One example of credential manipulation is by using PowerShell commands or
        ...
    - relation: atomicity::implements
      vector: a566e405-e9db-475f-8447-7875fa127716 #Script execution on Windows for credential manip...
      description: |
        One example of script execution for credential manipulation is the use of a
        Python or other type of script to access and read/change a user's credential...
    - relation: sequence::preceeds
      vector: 2d0beed6-6520-4114-be1f-24067628e93c #Manipulation of credentials stored in LSASS
      description: |
        Credentials can be stored in the Local Security Authority Subsystem
        Service (LSASS) process in memory for use by the account. LSASS stores
        credentials...
  #cve:
    #-
  #misp:
    #-
  domains:
    - Enterprise
    - Private Cloud
    - Public Cloud 
  terrain: |
    A threat actor is using already compromised Windows endpoint.
  targets:
    - Desktop
    - Laptop
    - End-user
    - Workstations
    - Control Server
    - System admin
    - Public-Facing Servers
    - Web Application Servers 
  platforms:
    - Windows
    - Active Directory
  severity: Moderate incident
  leverage:
    - Tampering
  impact:
    - Nuisance
  viability: Likely
  description: |
    Credential manipulation on a local Windows endpoint refers to an act of
    modifying, altering, or stealing sensitive information such as usernames,
    passwords, and other authentication data.   

    An example of credential manipulation could be the usage of a tool, for
    example like Mimikatz to extract login credentials from memory or to
    manipulate and modify existing credentials stored on the local system.
    The threat actor could use these manipulated credentials to gain
    unauthorized access to other systems or network resources.   

    The threat actors abuse and some legitimate administrator tools, such as
    the Microsoft Sysinternals tool: ProcDump or Task Manager to dump lsass.exe
    process memory and to collect credentials. This approach is common and
    known as "living-off-the-land", which means usage of legit native Windows
    tools in order to avoid possible detection.   

    Threat actors can gather, modify or delete credentials on the local Windows
    system also by using Windows Explorer manually or with scrips to access
    local files that may store user's or system credentials. For example
    Keepass or other local databases which contain passwords.   

    Examples:   
    
    Threat actors are using Mimikatz LSADUMP Module to collect SAM registry
    hashes.   

    lsadump::sam   

    Or to extract credentials from LSASS Dump files. 
    Mimikatz module lsass.exe dumps credentials in a more stealthy mode.
    The lsass.exe process manages many user credential secrets and can be
    associated with credential theft behavior.   

    sekurlsa::minidump lsass.dmp
    log lsass.txt
    sekurlsa::logonPasswords   

    For extracting of Domain Controller cached credentials is used LSADUMP module:
    lsadump::cache   

    Locally, the threat actors can run sekurlsa Mimikatz module to obtain logon
    credentials:   

    sekurlsa::Minidump lsassdump.dmp
    sekurlsa::logonPasswords   

    Built-in Windows tools such as comsvcs.dll can also be used:   

    rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID lsass.dmp full   

    There are variety of different tools that the threat actors use for
    memory dump, for example:   

    - Taskmgr.exe
    - ProcDump
    - ProcessExplorer.exe
    - Process Hacker
    - SQLDumper
    - PowerSploit â€“ Out-MiniDump
    - VM Memory Dump Files
    - Hibernation Files   
