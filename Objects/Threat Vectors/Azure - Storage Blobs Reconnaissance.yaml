name: Azure - Storage Blobs Reconnaissance
criticality: High
references:
  public:
    1: https://learn.microsoft.com/en-us/azure/well-architected/service-guides/azure-blob-storage
    2: https://www.netspi.com/blog/technical-blog/cloud-pentesting/anonymously-enumerating-azure-file-resources/
    3: https://techcommunity.microsoft.com/blog/microsoftdefendercloudblog/protect-your-storage-resources-against-blob-hunting/3735238
    4: https://www.inversecos.com/2022/01/how-to-detect-and-compromise-azure.html
  #internal:
    #a: 

metadata:
  uuid: 41f57a57-1ed6-407e-bb70-a0f6ab52af10
  schema: tvm::2.1
  version: 3
  created: 2025-05-07
  modified: 2025-09-08
  tlp: clear
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  #actors:
    #- name: 
      #sighting: |
        #...
      #references:
        #-
  killchain: Reconnaissance
  att&ck:
    - T1530 #Data from Cloud Storage
    - T1552 #Unsecured Credentials
    - T1619 #Cloud Storage Object Discovery
    - T1567 #Exfiltration Over Web Service
    - T1190 #Exploit Public-Facing Application
  chaining:
    - relation: support::enabled
      vector: 53f4e2f0-7d11-4629-bb26-905993a589db #Azure storage account reconnaissance
      description: |
        Adversaries need to scan and discover publicly accessible storage containers by 
        guessing or enumerating storage account and container names.
    - relation: support::enabled
      vector: 2743bf18-3b86-4721-bf3e-153dcda0b149 #Azure - Valid Credentials
      description: |
        Adversaries obtain the username and password of an AzureAD user either through phishing, 
        password spraying, brute-force attacks, or credentials leaked online. 
    - relation: support::enabled
      vector: b1593e0b-1b3b-462d-9ab6-21d1c136469d #Azure - Gather Resource Data
      description: |
        The attacker obtains credentials (via phishing, password spray, leaked keys) granting 
        at least Reader access to the target Azure tenant.
    - relation: support::enabled
      vector: 53063205-4404-4e6d-a2f5-d566c6085d96 #Data collection using SharpHound, SoapHound, Bloodhound & Azurehound
      description: |
        Attackers need to establish an initial presence within the target environment, in 
        order to gather sufficient permissions to execute the data collection tools.
  #cve:
    #-
  #misp:
    #-
  domains:
    - Public Cloud   
  terrain: |
    Adversaries must have knowledge about the strucuture of
    Azure Blob Storage and naming conventions, and basic
    enumeration tools or scripts to carry out 
    reconnaissance-especially when misconfigurations or
    public access are present.
  targets:
    - Cloud Storage Accounts
    - Public-Facing Servers
    - API Endpoints
    - Software Containers
    - Virtual Machines
  platforms:
    - Azure
    - Azure AD
  severity: Significant incident
  leverage:
    - Information Disclosure
    - Infrastructure Compromise
    - Tampering
    - Spoofing 
  impact:
    - Data Breach
    - IP Loss
    - Reputational Damages
    - Identity Theft
    - Monetary Loss 
  viability: Likely
  description: |
    Reconnaissance targeting Azure Storage Blobs involves gathering intelligence to identify
    exposed storage accounts, containers, and blobs-often without authentication or detection.
    Azure’s predictable URL structure, common naming conventions, and potential for
    misconfiguration make it a prime target for such activities.

    ### Discovery of Storage Accounts

    - **DNS and Subdomain Enumeration:**  
    Each Azure Storage account is accessible via a unique subdomain
    (e.g., `yourstorageaccount.blob.core.windows.net`).   
    Attackers use DNS enumeration tools (like `dnscan`) and wordlists to guess or 
    discover valid storage account names. They often use company names, abbreviations, 
    or product names as starting points.

    - **Search Engine Dorking:**  
    Publicly accessible blobs and containers may be indexed by search engines. Attackers 
    leverage advanced search queries (Google dorking), such as `site:*.blob.core.windows.net`, 
    to find open blob storage accounts and even specific file types (e.g., `.csv`, `.xlsx`) 
    or keywords like `"password"`.

    ### Enumeration of Containers and Blobs

    - **URL Pattern Guessing:**  
    Azure Blob Storage uses predictable URL patterns for containers and blobs. Attackers 
    automate requests to likely container names (e.g., `backups`, `images`, `prod`) 
    and blob names, increasing the odds of finding exposed data.

    - **Automated Scanning Tools:**  
    Tools like MicroBurst, goblob, and custom scripts are used to automate the enumeration 
    of storage accounts, containers, and blobs. These tools can quickly test thousands 
    of possible names, scaling up the reconnaissance process.

    - **Custom Wordlists:**  
    Attackers may build custom dictionaries based on the target’s business, products, 
    or previously leaked information to improve the accuracy of their enumeration efforts.

    ### Analysis of Exposed Data and Metadata

    - **Monitoring Access Patterns:**  
    By analyzing metadata (timestamps, blob sizes, file types), attackers can infer 
    which blobs or containers are most likely to contain sensitive or valuable information.

    - **Chaining Exposures:**  
    If attackers find an exposed blob, they may discover references within the files 
    themselves (e.g., database connection strings, links to other storage accounts), 
    allowing them to recursively enumerate and compromise further resources.

    ### Tenant and Service Enumeration

    - **Azure Tenant Discovery:**  
    Attackers can leverage known company domains or public APIs to enumerate Azure tenants 
    and services, including blob storage endpoints. Tools like MicroBurst and AADInternals 
    automate the discovery of tenant IDs and service endpoints, providing additional 
    reconnaissance data.

    ### Reconnaissance Characteristics

    - **Silent and Non-Intrusive:**  
    Most reconnaissance activities are passive and do not require authentication, making 
    them difficult to detect until exploitation occurs.

    - **Scalable and Automated:**  
    Attackers can automate the entire process, rapidly scanning large numbers of potential 
    storage accounts and containers.

    ### Real-World Impact

    - **Sensitive Data Exposure:**  
    Even a single misconfigured blob can expose sensitive data, credentials, or internal 
    documentation, which can be leveraged for further attacks.

    - **Pivoting and Lateral Movement:**  
    Exposed blobs may contain information that allows attackers to pivot to other services 
    or escalate their access within the target environment.
