name: Grager backdoor
criticality: High
references:
  public:
    1: https://www.security.com/threat-intelligence/cloud-espionage-attacks
    2: https://www.csoonline.com/article/3483919/apt-groups-increasingly-attacking-cloud-services-to-gain-command-and-control.html
    3: https://candid.technology/unc5330-gogra-trojan-onedrive-google-drive-micorosft-mail/
    4: https://cloud.google.com/blog/topics/threat-intelligence/ivanti-post-exploitation-lateral-movement
  #reports:
    #-

metadata:
  uuid: 662af2da-7017-4899-88fc-e77617a15130
  schema: tvm::2.0
  version: 1
  created: 2024-10-16
  modified: 2024-10-16
  tlp: clear
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  #actors:
    #- UNC5330 - there are links between Grager and an APT group tracks as UNC5330 because the same trojanized 7-Zip installer also dropped a backdoor dubbed Tonerjam associated with this group.
  killchain: Exploitation
  # Exfiltration of data
  att&ck:
    - T1071 # Application Layer Protocol
    - T1105 # Ingress Tool Transfer
    - T1059 # Command and Scripting Interpreter
  #chaining:
    #- relation: 
      #vector: 
      #description: |
        #Type Here
  #cve:
    #-
  domains:
    - Enterprise
    - Private Cloud
    - Public Cloud
  terrain: |
    A threat actor uses vulnerable Microsoft Graph APIs to deploy
    the malware and contact the C&C server.   
  targets:
    - Workstations
    - Customer
    - Desktop # the malware is compatible with Windows Desktop
    - Control Server
    - Media # this malware is observed as a step of a campaign which targets South East Asia media and military organizations
  platforms:
    - Windows
  severity: Moderate incident
  leverage:
    - Dwelling
    - Infrastructure Compromise
    - Elevation of privilege
    - Information Disclosure
    - Software installation
  impact:
    - Business disruption
    - Impairement
    - Data Breach
    - Reputational Damages
  viability: Likely
  description: |
    A previously unseen backdoor named Grager was deployed against three
    organizations in the past - Taiwan, Hong Kong, and Vietnam in April
    2024. Trojan.Grager is a second APT malware implant leveraging the
    Microsoft Graph API from a multi-step malware campaign abusing
    cloud services ref [1, 2].  
    
    The analysis of the backdoor revealed that it used the Graph
    API to communicate with a C&C server hosted on Microsoft OneDrive.
    Grager was downloaded from a typosquatted URL mimicking an open-
    source file archiver 7-Zip (7 zip .msi file) ref [1].  

    The .msi dropper, is a Trojanized 7-Zip installer that installs
    the real 7-Zip software into the Windows Program Files folder
    (C:\Program Files (x86)\7-Zip) along with a malicious DLL named
    `epdevmgr.dll`, a copy of the Tonerjam malware, and the encrypted
    Grager backdoor into a file named `data.dat` ref [1].   
    
    The backdoor leverages a custom application layer protocol for
    communication with its command and control server, allowing it to bypass
    traditional network security tools and evade detection. Grager employs
    various stealth techniques, such as obfuscation and anti-analysis methods,
    to evade antivirus software and remain undetected.  

 
