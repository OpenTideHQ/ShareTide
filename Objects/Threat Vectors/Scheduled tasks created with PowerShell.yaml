name: Scheduled tasks created with PowerShell
criticality: Medium
references:
  public:
    1: https://devblogs.microsoft.com/scripting/use-powershell-to-create-scheduled-tasks/
    2: https://attack.mitre.org/techniques/T1053/005/
    3: https://learn.microsoft.com/en-us/windows/win32/taskschd/about-the-task-scheduler
    4: https://www.microsoft.com/en-us/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/
    5: https://redcanary.com/threat-detection-report/techniques/powershell/
  #internal:
    #a: 
  #restricted:
    #A: 
  #reports:
    #-

metadata:
  uuid: a5f631c3-6fb0-484f-89e4-c8b2e038db8f
  schema: tvm::2.0
  tlp: clear
  version: 1
  created: 2022-12-15
  modified: 2022-12-15
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  #actors:
    #- 
  killchain: Execution
  att&ck:
    - T1053.005
  domains:
    - Enterprise
    - Public Cloud
  terrain: |
    An adversary has gained control over a Windows endpoint and has  
    privileges to create scheduled tasks using PowerShell.exe
  targets:
    - Workstations
    - Control Server
    - Input/Output Server
    - Laptop
    - Desktop
    - Remote access
    - Web Application Servers
    - Public-Facing Servers
  platforms:
    - Windows
  severity: Moderate incident
  leverage:
    - Dwelling
  impact:
    - Impairement
  viability: Likely
  description: |
    A threat actor can use PowerShell to create tasks for nefarious purposes. 
 
    Scripts requires admin rights to create a new scheduled task. The script 
    will run in the context of the user who created the scheduled task.

    Scheduled tasks are typically used to either connect to adversary 
    infrastructure, establish persistence or to execute binaries.

    



    

    
