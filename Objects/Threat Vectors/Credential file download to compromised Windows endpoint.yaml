name: Credential file download to compromised Windows endpoint
criticality: Medium
references:
  public:
    1: https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system
    2: https://www.elastic.co/guide/en/security/8.17/potential-file-transfer-via-curl-for-windows.html
    3: https://www.nirsoft.net/utils/remote_desktop_password.html
    4: https://www.digitalcitizen.life/credential-manager-where-windows-stores-passwords-other-login-details/
    5: https://serverfault.com/questions/770996/where-does-credential-manager-store-credentials-on-the-file-system
    6: https://www.proofpoint.com/us/blog/threat-insight/whatta-ta-ta505-ramps-activity-delivers-new-flawedgrace-variant
    7: https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter
    8: https://www.mandiant.com/resources/blog/apt33-insights-into-iranian-cyber-espionage
    9: https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/leafminer-espionage-middle-east
    
  #internal:
    #a: 

metadata:
  uuid: 94b7287b-ae84-4b89-8093-63898c7475c9
  schema: tvm::2.1
  version: 1
  created: 2025-03-12
  modified: 2025-03-12
  tlp: clear
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: att&ck::G0092 #[Enterprise] TA505, CHIMBORAZO, Hive0065, Spandex Tempest
    - name: misp::03c80674-35f8-4fe0-be2b-226ed0fcd69f #TA505
      #sighting: |
        #...
      references:
        - https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter
    
    - name: att&ck::G0077 #[Enterprise] Leafminer, Raspite
    - name: misp::2c8994ba-367c-46f6-bfb0-390c8760dd9e #RASPITE
      #sighting: |
        #...
      references:
        - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/leafminer-espionage-middle-east
    
    - name: att&ck::G0064 #[ICS] APT33, Elfin, HOLMIUM, Peach Sandstorm
    - name: misp::4f69ec6d-cb6b-42af-b8e2-920a2aa4be10 #APT33
      #sighting: |
        #...
      references:
        - https://www.mandiant.com/resources/blog/apt33-insights-into-iranian-cyber-espionage
  killchain: Credential Access
  att&ck:
    - T1552.001 # Unsecured Credentials: Credentials In Files
    - T1555.004 # Credentials from Password Stores: Windows Credential Manager
  #cve:
    #-
  #misp:
    #-
  domains:
    - Enterprise
    - Private Cloud
    - Public Cloud
  terrain: |
    Requires an already compromised Windows endpoint.  
  targets:
    - Desktop
    - Workstations
    - Control Server
    - Laptop
    - Production Database
    - End-user
    - Remote access # Download remotely Windows credential files, TA may use different remote tools
  platforms:
    - Windows
  severity: Moderate incident
  leverage:
    - Tampering
    - Infrastructure Compromise
  impact:
    - Identity Theft
    - Lose Capabilities
    - Nuisance
    - Reputational Damages
  viability: Likely
  description: |
    A credential file download to Windows compromised endpoint
    refers to a process where an attacker downloads sensitive
    credential files to this system. A threat actor usually
    target to download files containing passwords, authentication
    tokens, or other sensitive information. Threat actors may use
    remote tools to download Windows credential files and to
    extract their content if its decrypted ref [1], [2].  

    ### Methods used by the threat actors

    Threat actors may use various methods to download credential files,
    for example:

    - SMB (Server Message Block) exploitation: Attackers may exploit
    vulnerabilities in SMB to gain access to the compromised endpoint
    and download credential files.
    - PowerShell scripts: Attackers may use PowerShell scripts to
    download credential files from the compromised endpoint.
    - Remote Desktop Protocol (RDP): Attackers may use RDP to gain
    access to the compromised endpoint and download credential files.
    - Malware: Attackers may use malware to download credential files
    from the compromised endpoint.
    - Curl for Windows (via HTTP requests) - Adversaries could abuse
    `Curl` to download files or upload data to a remote URL address
    ref [2].  
    - Remote Desktop PassView - this tool can access Windows credential
    files via .rdp files. It's possible such file to contain user's
    credentials ref [3]. 

    ### Known types of files which may contain user's credentials 
    
    The following types of credential files may be downloaded by the
    attackers through a compromised network:

    - SAM (Security Account Manager) files: These files contain hashed
    passwords for local user accounts.
    - NTDS.DIT files: These files contain hashed passwords for Active
    Directory user accounts.
    - Credential Manager files: These files contain stored credentials
    for applications and services.
    - SSH key files: These files contain private SSH keys used for
    authentication.  

    ### An example 

    Threat actors can download and use the accessed credential user's
    files to connect to a database further, without having to enter
    login credentials each time they access the database. The database
    system will authenticate their login based on the information
    stored in the credential file.   
