name: Password spraying attack
criticality: High
references:
  public:
    1: https://depthsecurity.com/blog/spray-365-a-new-twist-on-office-365-password-spraying
    2: https://capec.mitre.org/data/definitions/565.html # Password Spraying description
    3: https://learn.microsoft.com/en-us/security/operations/incident-response-playbook-password-spray # Microsoft Entra connect health tool for ADFS
    4: https://www.microsoft.com/en-us/security/blog/2021/10/26/protect-your-business-from-password-sprays-with-microsoft-dart-recommendations/
    5: https://learn.microsoft.com/en-us/defender-xdr/alert-classification-password-spray-attack?view=o365-worldwide
    6: https://en.wikipedia.org/wiki/Microsoft_Entra_ID # Microsoft Entra ID informative link

metadata:
  uuid: cc546bbc-f71c-4538-934c-415d6adc293b
  schema: tvm::2.0
  version: 3
  created: 2024-03-27
  modified: 2025-10-01
  tlp: clear
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: att&ck::G0016 #[Enterprise] APT29, Blue Kitsune, Cozy Bear, CozyDuke, Dark Halo, IRON HEMLOCK, IRON RITUAL, Midnight Blizzard, NOBELIUM, NobleBaron, SolarStorm, The Dukes, UNC2452, UNC3524, YTTRIUM
    - name: misp::2ee5ed7a-c4d0-40be-a837-20817474a15b #UNC2452, DarkHalo, StellarParticle, NOBELIUM, Solar Phoenix, Midnight Blizzard
    - name: att&ck::G0007 #[Enterprise] APT28, FROZENLAKE, Fancy Bear, Forest Blizzard, Group 74, IRON TWILIGHT, Pawn Storm, SNAKEMACKEREL, STRONTIUM, Sednit, Sofacy, Swallowtail, TG-4127, Threat Group-4127, Tsar Team
    - name: misp::5b4ee3ea-eee3-4c8e-8323-85ae32658754 #APT28, Pawn Storm, FANCY BEAR, Sednit, SNAKEMACKEREL, Tsar Team, TG-4127, STRONTIUM, Swallowtail, IRON TWILIGHT, Group 74, SIG40, Grizzly Steppe, G0007, ATK5, Fighting Ursa, ITG05, Blue Athena, TA422, T-APT-12, APT-C-20, UAC-0028, FROZENLAKE, Sofacy, Forest Blizzard, BlueDelta, Fancy Bear, GruesomeLarch
    - name: att&ck::G0082 #[Enterprise] APT38, BeagleBoyz, Bluenoroff, COPERNICIUM, NICKEL GLADSTONE, Sapphire Sleet, Stardust Chollima
    - name: misp::68391641-859f-4a9a-9a1e-3e5cf71ec376 #Lazarus Group, Operation DarkSeoul, Dark Seoul, Hidden Cobra, Hastati Group, Andariel, Unit 121, Bureau 121, NewRomanic Cyber Army Team, Bluenoroff, Subgroup: Bluenoroff, Group 77, Labyrinth Chollima, Operation Troy, Operation GhostSecret, Operation AppleJeus, APT38, APT 38, Stardust Chollima, Whois Hacking Team, Zinc, Appleworm, Nickel Academy, APT-C-26, NICKEL GLADSTONE, COVELLITE, ATK3, G0032, ATK117, G0082, Citrine Sleet, DEV-0139, DEV-1222, Diamond Sleet, ZINC, Sapphire Sleet, COPERNICIUM, TA404, Lazarus group, BeagleBoyz
    - name: att&ck::G0114 #[Enterprise] Chimera
    - name: att&ck::G0004 #[Enterprise] Ke3chang, APT15, GREF, Mirage, NICKEL, Nylon Typhoon, Playful Dragon, RoyalAPT, Vixen Panda
    - name: misp::3501fbf2-098f-47e7-be6a-6b0ff5742ce8 #APT15, VIXEN PANDA, Ke3Chang, Playful Dragon, Metushy, Lurid, Social Network Team, Royal APT, BRONZE PALACE, BRONZE DAVENPORT, BRONZE IDLEWOOD, NICKEL, G0004, Red Vulture, Nylon Typhoon, Mirage
    - name: att&ck::G0069 #[Enterprise] MuddyWater, Earth Vetala, MERCURY, Mango Sandstorm, Seedworm, Static Kitten, TA450, TEMP.Zagros
    - name: misp::a29af069-03c3-4534-b78b-7d1a77ea085b #MuddyWater, TEMP.Zagros, Static Kitten, Seedworm, MERCURY, COBALT ULSTER, G0069, ATK51, Boggy Serpens, Mango Sandstorm, TA450, Earth Vetala
    - name: att&ck::G0077 #[Enterprise] Leafminer, Raspite
    - name: misp::2c8994ba-367c-46f6-bfb0-390c8760dd9e #RASPITE, LeafMiner, Raspite
    - name: att&ck::G0064 #[Enterprise] APT33, Elfin, HOLMIUM, Peach Sandstorm
    - name: misp::4f69ec6d-cb6b-42af-b8e2-920a2aa4be10 #APT33, APT 33, Elfin, MAGNALLIUM, Refined Kitten, HOLMIUM, COBALT TRINITY, G0064, ATK35, Peach Sandstorm, TA451
  killchain: Credential Access
  att&ck:
    - T1110.003 #Brute Force: Password Spraying
  #chaining:
    #- relation: 
      #vector: 
      #description: |
        #Type Here
  #cve:
    #-
  domains:
    - Enterprise
    - Private Cloud
    - Public Cloud
  terrain: |
    Adversaries must look for different accounts to test a list of different
    frequently used weak passwords. To have success, the attacker need to 
    research what are the valid account patterns used for the Internet-facing
    applications used by the organisation such as VPN service or O365.  
  targets:
    - End-user
    - Former employee
    - Executive
  platforms:
    - Windows
    - Linux
    - AWS
    - Azure
    - AD FS
    - Active Directory
  severity: Significant incident
  leverage:
    - Information Disclosure
    - Infrastructure Compromise
    - Modify privileges
  impact:
    - Identity Theft
    - Nuisance
  viability: Roughly even chance
  description: |
    Password spraying is a technique that attackers use to try a small list
    of common or expected passwords against a set of usernames. This technique
    is used to avoid account lockouts that would normally occur when brute
    forcing a single account with many passwords1. Password spraying is a
    sub-technique of credential spraying, which is just credential guessing
    but "sprayed" (i.e. against multiple accounts). (ref [1], [2])  

    Adversaries have been observed using password spray attacks to exploit
    logins of network services or credential harvesting, typically used
    to obtain initial foothold.

    They attempt username and password combinations in a slow manner,
    researching the pattern for valid accounts (e.g. email address or username
    length). Organizations targeted typically see a few authentication attempts
    per account; with nearly every attempt originating from constantly rotating
    IP addresses, many associated with the Tor anonymizing service.  

    Some strategies conducted by adversaries are:  

    - Credential stuffing towards Microsoft Office 365 accounts, there are
    tools that identify valid credentials for Office 365 and Azure AD accounts,
    as Spray365.  

    - Abuse of Exchange servers. There are tools for searching through email
    in an Exchange environment for specific terms (passwords, insider intel,
    network architecture information, etc.) as for example MailSniper; which
    includes modules for password spraying, enumerating users and domains or
    gathering the Global Address List (GAL) from OWA and EWS.  

    - Password spray against exposed Active Directory Federation Services
    (ADFS) infrastructure. The organizations not using MFA have a higher risk
    of having accounts compromised through password spray. If attack is
    successful, adversaries may look for additional contacts, sensitive
    information, privileged information, or send phishing links to
    others in the organization.  


    - Password spraying attack against Microsoft Entra ID applications
    Password spray attacks involve trying a few common passwords against
    specific or many accounts. This may include and attack against the
    cloud-based Microsoft application solution: Microsoft Entra ID. The
    goal is to bypass traditional protections like password lockout and
    malicious IP blocking. They can include low number of login attempts
    or lack of consistency which makes them difficult to detect.  


