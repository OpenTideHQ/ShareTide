name: Admin SMB shares privilege escalation exploit
criticality: Medium
references:
  public:
    1: https://redcanary.com/threat-detection-report/techniques/windows-admin-shares
    2: https://www.pentesting.org/file-sharing-attacks/
    3: https://www.cayosoft.com/smb-vulnerability
    4: https://securityonline.info/windows-smb-flaw-cve-2025-33073-system-privilege-escalation-via-kerberos-poc-available
    5: https://windowsforum.com/threads/cve-2025-33073-critical-windows-smb-privilege-escalation-vulnerability-explained.369790 # SMB elevation of privileges vulnerability `CVE-2025-33073`
    6: https://www.thehackacademy.com/news/microsoft-issues-emergency-fix-for-severe-windows-smb-vulnerability-update-now
    7: https://www.security.com/threat-intelligence/chafer-latest-attacks-reveal-heightened-ambitions # APT39 threat actor is related to SMB privilege escalation techniques and lateral movement
  #internal:
    #a: 

metadata:
  uuid: 02810748-52b5-4d3a-a788-29a948538cd2
  schema: tvm::2.1
  version: 1
  created: 2025-07-29
  modified: 2025-08-26
  tlp: clear
  #author: 
  #contributors:
    #-
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: att&ck::G0087 #[Enterprise] APT39, Chafer, ITG07, Remix Kitten
    - name: misp::c2c64bd3-a325-446f-91a8-b4c0f173a30b #APT39, Chafer, REMIX KITTEN, COBALT HICKMAN, G0087, Radio Serpens, TA454, ITG07, Burgundy Sandstorm
      sighting: |
        APT39 is a vietnam-based threat group known to use SMB for lateral
        movement.
      references:
        - https://www.security.com/threat-intelligence/chafer-latest-attacks-reveal-heightened-ambitions
  killchain: Privilege Escalation
  att&ck:
    - T1210      # Exploitation of Remote Services   | A threat actor may exploit vulnerabilities in remote services, including Admin SMB shares, to gain unauthorized access or escalate privileges.
    - T1078      # Valid Accounts                    | Adversaries may use valid accounts, such as administrative accounts, to access and exploit Admin SMB shares.
    - T1021.002  # SMB/Windows Admin Shares          | SMB privilege escalation can use Admin SMB shares to exploit and access remote services (example: file shares, printers, or other network resources)
    - T1570      # Lateral Tool Transfer             | This technique can be related as post-expoitation step after a threat actor gains an access and privilege access to SMB share
  chaining:
    - relation: atomicity::implements
      vector: 75415bc5-6615-487e-a69c-7a4ffc196996 # Lateral movement using Impacket framework
      description: |
        A threat actor can use offensive tools, for example Impacket, WMIexec
        or others to leverage and gain hiher access privileges like SMB Share
        Admin.
        
    - relation: sequence::succeeds
      vector: f33a693b-04cd-476e-9067-9deab561e55a # Move laterally with SMB by abusing WMI
      description: |
        Threat actors can use a lateral movement technique in the environment
        after exploitation of an SMB share.  
  cve:
    - CVE-2025-33073 # Vulnerability leads to SMB elevation of privileges, rooted in weaknesses in access control handling by the Windows SMB Client. 
  #misp:
    #-
  domains:
    - Enterprise
  terrain: |
    A threat actor needs to have initial access to a machine that has remote or 
    local SMB share connectivity.    
  targets:
    - Public-Facing Servers
    - Workstations
    - Web Application Servers
  platforms:
    - Windows
  severity: Moderate incident
  leverage:
    - Elevation of privilege
    - Infrastructure Compromise
    - Information Disclosure
  impact:
    - Data Breach
    - Impairement
  viability: Likely
  description: |
    One of the most common ways adversaries leverage SMB and Windows Admin
    Shares is in conjunction with another technique, T1570: Lateral Tool
    Transfer. In other words, they move payloads from one endpoint to another
    and execute them. Adversaries do this with native utilities like net.exe or
    through functionality provided by command and control (C2) frameworks - to
    name just a couple of the many options available. Additionally, adversaries
    can use Admin Shares for privilege escalation using tools like PsExec, a 
    Sysinternals tool that enables remote system management.

    ### Possible patterns of malicious activity

    - Remote file copy and retrieval - attackers can use tools such as SMBexec to 
    create a temporary share to copy files to and then remotely parse their 
    contents. An adversary could accomplish this similarly by leveraging tools 
    like WMIexec or MMCexec.

    - Lateral movement and privilege escalation - Most C2 Frameworks provide 
    built-in functionality for lateral movement or privilege escalation utilizing 
    PsExec-like functionality. In the case of Cobalt Strike, beacons leverage the 
    Service Control Manager to copy a binary to the ADMIN$ share on the target 
    endpoint and leverage a service for execution.

    Common offensive and dual-use tools that leverage SMB/Windows Admin Shares 
    include:

    - PsExec
    - Impacket's SMBexec and WMIexec
    - `net.exe`
    - Probably all C2 frameworks (commercial and open source)
