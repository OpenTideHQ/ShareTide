name: Windows credential creation attempt
criticality: High
references:
  public:
    1: https://learn.microsoft.com/en-us/windows-server/security/windows-authentication/credentials-processes-in-windows-authentication
    2: https://woshub.com/saved-passwords-windows-credential-manager/
    3: https://help.fortinet.com/fsiem/Public_Resource_Access/7_1_0/rules/PH_RULE_Windows_Credential_Editor.htm
  #internal:
    #a: 

metadata:
  uuid: 09b9aee8-3849-4578-8243-17157d6d54e0
  schema: tvm::2.1
  version: 1
  created: 2025-02-10
  modified: 2025-02-14
  tlp: clear
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: misp::bdf4fe4f-af8a-495f-a719-cf175cecda1f #WIZARD SPIDER
    - name: att&ck::G0102 #[ICS] Wizard Spider, DEV-0193, FIN12, GOLD BLACKBURN, Grim Spider, ITG23, Periwinkle Tempest, TEMP.MixMaster, UNC1878
      #sighting: |
          #...
      references:
          - https://github.com/attackevals/ael/blob/main/Enterprise/wizard_spider/Operations_Flow/Operations_Flow.md # Wizard Spider TA credential dumping
    - name: misp::d9e5be22-1a04-4956-af6c-37af02330980 #LAPSUS
    - name: att&ck::G1004 #[Enterprise] LAPSUS$, DEV-0537, Strawberry Tempest
      sighting: |
          This threat actor group is known and observed to use access
          to local password managers and databases to obtain user's
          credentials. They use variety of techniques to gather
          credentials and other valuable information and after
          to trade it on the black markets.      
      references:
          - https://www.nccgroup.com/us/research-blog/lapsus-recent-techniques-tactics-and-procedures/
  killchain: Credential Access
  att&ck:
    - T1078     # Valid Accounts
    - T1552.001 # Unsecured Credentials: Credentials In Files
    - T1003     # OS Credential Dumping
    - T1078.003 # Valid Accounts: Local Accounts
    - T1136     # Create Account
    - T1550.004 # Use Alternate Authentication Material: Web Session Cookie
  chaining:
    - relation: sequence::succeeds
      vector: 444e014f-d830-4d0d-9c2e-1f76d80ba380 # Windows credential dumping through Local Security Authority (LSA) Secrets
      description: |
        A threat actor can use a technique for Local Security Authority
        (LSA) Secrets dumping in order to abuse a Windows process and
        in this way to initiate a process, passing the credentials
        collected by the Windows user.     
  #cve:
    #-
  #misp:
    #-
  domains:
    - Enterprise
    - Private Cloud
    - Public Cloud
  terrain: |
    A threat actor needs a valid and privileged accounts 
    or equivalent  
  targets:
    - Auth token
    - Customer
    - Laptop
    - Web Application Servers
    - Workstations
    - Remote access
  platforms:
    - Windows
  severity: Significant incident
  leverage:
    - Dwelling
    - Elevation of privilege
    - New Accounts
    - Modify configuration
    - Tampering
  impact:
    - Business disruption
    - Identity Theft
    - Impairement
    - Lose Capabilities
    - Reputational Damages
  viability: Environment dependent
  description: |
    ### Windows Credential Creation Attempt
    A Windows credential creation attempt refers to 
    activities where a user or system processes aim 
    to create, store, or manipulate sets of credentials 
    (e.g., username and password) within a Windows 
    environment. This can involve legitimate system 
    operations or malicious activities by threat actors 
    seeking unauthorized access.

    #### Examples of Windows Credential Creation Attempt
    **User Account Creation:**

    - Using administrative command-line tools such as 
    `net user` to add new user accounts.
    - Leveraging PowerShell scripts or commands to automate 
    the creation of user accounts.
    `New-LocalUser`: Create a new local user account with 
    `New-LocalUser -Name "[username]"` 
    `-Password (ConvertTo-SecureString "[password]"` 
    `-AsPlainText -Force)`.
    
    **Abuse of Winlogon:**  

    Winlogon.exe is responsible for managing secure user 
    interactions during logon. Threat actors can exploit 
    this process to pass harvested credentials to the 
    Local Security Authority (LSA), thereby impersonating 
    legitimate users.

    **Saved Passwords in Credential Manager:**  

    Threat actors can exploit stored credentials in the 
    Windows Credential Manager. These credentials can be 
    used to automatically log into various services or 
    create new user accounts using the gathered information.
    
    **Credential Injection:**  

    Using tools or scripts to inject credentials directly 
    into the Windows Security Accounts Manager (SAM) 
    database or LSA to create or modify credentials.
    
    **Known Tools for Credential Creation and Manipulation**
    
    - **Windows Credential Editor (WCE):** 
    WCE is a tool capable of listing logon sessions and 
    modifying associated credentials, such as adding or 
    changing NTLM hashes, plaintext passwords, and 
    Kerberos tickets. It can be misused to create unauthorised 
    credentials on a Windows system.
