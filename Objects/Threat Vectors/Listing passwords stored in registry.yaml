name: Listing passwords stored in registry
criticality: High
references:
  public:
    1: https://www.ired.team/offensive-security/credential-access-and-credential-dumping/t1214-credentials-in-registry
    2: https://research.splunk.com/endpoint/a8b3124e-2278-4b73-ae9c-585117079fb2/
    3: https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/credential-access/t1552-unsecured-credentials/credentials-in-registry
  #internal:
    #a: 
  #reports:
    #-

metadata:
  uuid: 0834302b-90d3-45ec-95d1-3e41ec14f7c6
  schema: tvm::2.0
  version: 1
  created: 2024-11-27
  modified: 2024-11-27
  tlp: clear
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  actors:
    - name: att&ck::G0050 #[Enterprise] APT32, APT-C-00, BISMUTH, Canvas Cyclone, OceanLotus, SeaLotus
    - name: misp::aa29ae56-e54b-47a2-ad16-d3ab0242d5d7 #APT32, OceanLotus Group, Ocean Lotus, OceanLotus, Cobalt Kitty, APT-C-00, SeaLotus, Sea Lotus, APT-32, APT 32, Ocean Buffalo, POND LOACH, TIN WOODLAWN, BISMUTH, ATK17, G0050, Canvas Cyclone
    - name: att&ck::G0007 #[Enterprise] APT28, FROZENLAKE, Fancy Bear, Forest Blizzard, Group 74, IRON TWILIGHT, Pawn Storm, SNAKEMACKEREL, STRONTIUM, Sednit, Sofacy, Swallowtail, TG-4127, Threat Group-4127, Tsar Team
    - name: misp::5b4ee3ea-eee3-4c8e-8323-85ae32658754 #APT28, Pawn Storm, FANCY BEAR, Sednit, SNAKEMACKEREL, Tsar Team, TG-4127, STRONTIUM, Swallowtail, IRON TWILIGHT, Group 74, SIG40, Grizzly Steppe, G0007, ATK5, Fighting Ursa, ITG05, Blue Athena, TA422, T-APT-12, APT-C-20, UAC-0028, FROZENLAKE, Sofacy, Forest Blizzard, BlueDelta, Fancy Bear, GruesomeLarch
    - name: att&ck::G0016 #[Enterprise] APT29, Blue Kitsune, Cozy Bear, CozyDuke, Dark Halo, IRON HEMLOCK, IRON RITUAL, Midnight Blizzard, NOBELIUM, NobleBaron, SolarStorm, The Dukes, UNC2452, UNC3524, YTTRIUM
    - name: misp::2ee5ed7a-c4d0-40be-a837-20817474a15b #UNC2452, DarkHalo, StellarParticle, NOBELIUM, Solar Phoenix, Midnight Blizzard
    - name: att&ck::G0102 #[Enterprise] Wizard Spider, DEV-0193, FIN12, GOLD BLACKBURN, Grim Spider, ITG23, Periwinkle Tempest, TEMP.MixMaster, UNC1878
    - name: misp::3c2bb7d7-a085-4594-adc7-4a20cf724abb #UNC1878
    - name: att&ck::G0010 #[Enterprise] Turla, BELUGASTURGEON, Group 88, IRON HUNTER, Krypton, Secret Blizzard, Snake, Venomous Bear, Waterbug, WhiteBear
    - name: misp::fa80877c-f509-4daf-8b62-20aba1635f68 #Turla, Snake, VENOMOUS Bear, Group 88, Waterbug, WRAITH, Uroburos, Pfinet, TAG_0530, KRYPTON, Hippo Team, Pacifier APT, Popeye, SIG23, IRON HUNTER, MAKERSMARK, ATK13, G0010, ITG12, Blue Python, SUMMIT, UNC4210, Secret Blizzard, UAC-0144, UAC-0024, UAC-0003
  killchain: Collection
  att&ck:
    - T1552.002 #Unsecured Credentials: Credentials in Registry
  #chaining:
    #- relation: 
      #vector: 
      #description: |
        #Type Here
  #cve:
    #-
  #misp:
    #-
  domains:
    - Enterprise
  terrain: |
    Adversary must have access to a Windows system where applications store credentials 
    in the registry and possess sufficient privileges to read registry keys 
    containing those credentials.
  targets:
    - Workstations
    - Laptop
    - Desktop
    - Virtual Machines
  platforms:
    - Windows
    - Active Directory
    - PowerShell
  severity: Significant incident
  leverage:
    - Information Disclosure
    - Dwelling
    - Spoofing
  impact:
    - Data Breach
    - Identity Theft
    - Business disruption
  viability: Likely
  description: |
    Listing passwords stored in the Windows Registry is a technique employed by adversaries 
    to extract sensitive credentials from compromised systems. The Windows Registry is a 
    centralized database that stores configuration settings and options for the operating 
    system and installed applications. Some applications, due to misconfigurations or poor 
    security practices, store user credentials in the registry, sometimes in plaintext 
    or in an easily reversible format.  

    Threat actors may use the built-in Windows command-line utility reg.exe to query registry 
    keys that potentially contain stored credentials.  

    ```bat
    reg query HKLM /f password /t REG_SZ /s
    ```
    This command is scanning registry hives for the value password.  

    PowerShell provides a powerful scripting environment that can recursively search the 
    registry for keys containing specific terms like "password."  

    ```powershell
    Get-ChildItem -Path Registry:: -Recurse -ErrorAction SilentlyContinue |
    Get-ItemProperty |
    Where-Object { $_.PSObject.Properties.Name -match "Password" -and $_.Password }
    ```
    This script searches all registry keys for properties named "Password" and lists them if found.  

    Some applications store credentials in specific registry locations. For example, 
    VPN clients or database tools might store user credentials under their software keys in HKCU or HKLM hives.
