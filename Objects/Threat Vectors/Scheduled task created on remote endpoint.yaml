name: Scheduled task created on remote endpoint
criticality: Medium
references:
  public:
    1: https://devblogs.microsoft.com/scripting/weekend-scripter-use-powershell-to-otely-create-scheduled-task-and-folder/
    2: https://redcanary.com/threat-detection-report/techniques/scheduled-task/
    3: https://www.action1.com/how-to-different-ways-to-create-scheduled-task-otely/
  #internal:
    #a: 
  #restricted:
    #A: 
  #reports:
    #-

metadata:
  uuid: d11bfb38-3a0c-4e38-a973-efa2da1e8a73
  schema: tvm::2.0
  tlp: clear
  version: 1
  created: 2022-12-15
  modified: 2022-12-15
  organisation:
    uuid: 56b0a0f0-b0bc-47d9-bb46-02f80ae2065a
    name: EC DIGIT CSOC

threat:
  #actors:
    #- 
  killchain: Persistence
#lateral movement, defense evasion also apply, to be updated once we can add multiple killchain stages here. 
  att&ck:
    - T1053
    - T1053.005
  domains:
    - Enterprise
    - Public Cloud
  terrain: |
    Threat actor uses an already compromised Windows endpoint. Requires administrative 
    credentials with permissions for remote task creation. Requires that
    Windows firewall on the remote endpoint allows “Remote Scheduled Tasks 
    Management”).
  targets:
    - Workstations
    - Control Server
    - Input/Output Server
    - Laptop
    - Desktop
    - Remote access
    - Web Application Servers
    - Public-Facing Servers
  platforms:
    - Windows
  severity: Moderate incident
  leverage:
    - Dwelling
    - Infrastructure Compromise
    - Modify configuration
    - Software installation
  impact:
    - Impairement
  viability: Likely
  description: |
    Adversaries with access to the right credentials can create scheduled tasks 
    remotely from an endpoint they control for malicious purposes, which often 
    include outbound connections to attacker infrastructure, binary execution, 
    achieve persistance or registry entry editing or creation, but in this case
    the remote scheduled task achieves lateral movement. 
  
    Adversaries can create and configure scheduled tasks on remote endpoints 
    using either the task scheduler or PowerShell.

    One example syntax used to create a new task on a remote computer is to 
    use \computername

    Examples: 

    at \\computername time/interactive | /every: date, ... /next: date, ... command
    at \\computername id/delete | /delete /yes

    Run a scheduled task on a remote mashine using PowerShell, example:

    schtasks /run /s ComputerName /tn “description”

    Using the task Scheduler, as example: > "Connect to Another Computer", 
    provide the IP address of the remote system and select "Connect as another 
    user" > "Set User".
